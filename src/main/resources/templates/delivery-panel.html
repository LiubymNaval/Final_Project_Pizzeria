<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head('Kuri√©r')}"></head>
<body>
<style>
    body { background-color: #0f0f0f !important; color: #ffffff !important; font-family: 'Segoe UI', sans-serif; }

    h1 {
        color: #e63946 !important;
        font-weight: 900;
        text-transform: uppercase;
        margin-bottom: 30px;
    }

    .card {
        background-color: #1a1a1a !important;
        border: 1px solid #333 !important;
        border-radius: 20px !important;
        overflow: hidden;
        transition: 0.3s;
    }

    .card-header {
        background-color: #252525 !important;
        border-bottom: 2px solid #ffc107 !important;
        color: #ffffff !important;
        padding: 15px 20px !important;
    }
    .order-id { color: #bbbbbb; font-weight: bold; }
    .order-price { color: #e63946; font-weight: 900; font-size: 1.3rem; }

    .address-section {
        background: rgba(255, 193, 7, 0.05);
        border-radius: 12px;
        padding: 15px;
        border-left: 4px solid #ffc107;
        margin-bottom: 20px;
    }
    .address-text { color: #ffffff !important; font-size: 1.4rem !important; line-height: 1.2; }

    .phone-link {
        color: #ffc107 !important;
        font-weight: bold;
        font-size: 1.1rem;
        text-decoration: none;
        display: inline-block;
        margin-top: 5px;
    }

    .list-group-item {
        background-color: transparent !important;
        border-bottom: 1px solid #333 !important;
        color: #eeeeee !important;
        padding: 8px 0 !important;
    }
    .item-qty { color: #e63946 !important; font-weight: 900; margin-right: 8px; }

    .alert-secondary {
        background-color: #222 !important;
        border: 1px solid #444 !important;
        color: #bbbbbb !important;
        border-radius: 12px;
    }

    .btn-lg {
        padding: 18px !important;
        font-weight: 800 !important;
        text-transform: uppercase;
        letter-spacing: 1px;
        border-radius: 12px !important;
    }

    .btn-primary {
        background-color: #e63946 !important;
        border: none !important;
    }
    .btn-primary:hover { background-color: #ff4d5a !important; }

    .btn-success {
        background-color: #198754 !important;
        border: none !important;
    }

    .text-muted-small {
        color: #888 !important;
        font-size: 0.75rem;
        text-transform: uppercase;
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
    }
</style>

<nav th:replace="~{fragments/layout :: header}"></nav>

<div class="container mt-4">
    <h1>üõµ Kuri√©r Panel</h1>

    <div class="row mt-3">
        <div class="col-md-6 mb-4" th:each="order : ${orders}">
            <div class="card shadow-lg h-100">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span class="order-id">Objedn√°vka <span class="text-white">#<span th:text="${order.id}"></span></span></span>
                    <span class="order-price"><span th:text="${order.celkovaCena}"></span> ‚Ç¨</span>
                </div>

                <div class="card-body">
                    <div class="address-section">
                        <span class="text-muted-small" style="color: #ffc107 !important;">Adresa doruƒçenia:</span>
                        <div class="address-text fw-bold" th:text="${order.adresa}">Hlavn√° 12, Nitra</div>
                    </div>

                    <div class="row mb-3">
                        <div class="col-7">
                            <span class="text-muted-small">Z√°kazn√≠k:</span>
                            <div class="fw-bold" th:text="${order.pouzivatel.meno} + ' ' + ${order.pouzivatel.priezvisko}">Meno</div>
                        </div>
                        <div class="col-5">
                            <span class="text-muted-small">Telef√≥n:</span>
                            <a th:href="'tel:' + ${order.pouzivatel.telefon}" class="phone-link">
                                üìû <span th:text="${order.pouzivatel.telefon}">0900...</span>
                            </a>
                        </div>
                    </div>

                    <div class="mb-3">
                        <span class="text-muted-small">Obsah objedn√°vky:</span>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item" th:each="item : ${order.polozky}">
                                <span class="item-qty" th:text="${item.mnozstvo} + 'x'">1x</span>
                                <span th:text="${item.archivnyNazov}">Pizza</span>
                            </li>
                        </ul>
                    </div>

                    <div class="mb-3" th:if="${order.poznamka}">
                        <span class="text-muted-small">Pozn√°mka:</span>
                        <p class="small fst-italic text-white-50" th:text="${order.poznamka}"></p>
                    </div>

                    <div th:if="${order.kurier != null}" class="alert alert-secondary py-2 mb-3">
                        <span class="text-muted-small">Priraden√Ω kuri√©r:</span>
                        <div class="d-flex align-items-center">
                            <span class="fs-4 me-3">üõµ</span>
                            <div>
                                <div class="fw-bold text-white" th:text="${order.kurier.meno} + ' ' + ${order.kurier.priezvisko}">Meno</div>
                                <div class="small">üìû <span th:text="${order.kurier.telefon}"></span></div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4">
                        <form th:if="${order.stav.name() == 'PRIPRAVENA'}"
                              th:action="@{/delivery/order/{id}/status(id=${order.id})}" method="post">
                            <input type="hidden" name="status" value="DORUCUJE_SA">
                            <button type="submit" class="btn btn-primary w-100 btn-lg shadow">
                                üöÄ Prevzia≈• (Na cestu)
                            </button>
                        </form>

                        <form th:if="${order.stav.name() == 'DORUCUJE_SA'}"
                              th:action="@{/delivery/order/{id}/status(id=${order.id})}" method="post">
                            <input type="hidden" name="status" value="DORUCENA">
                            <button type="submit" class="btn btn-success w-100 btn-lg shadow">
                                ‚úÖ Doruƒçen√© (Hotovo)
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div th:if="${#lists.isEmpty(orders)}" class="text-center mt-5 py-5">
        <div class="display-1 mb-3">‚òï</div>
        <h4 class="text-muted">≈Ωiadne objedn√°vky –Ω–∞ doruƒçenie. Oddychujte!</h4>
    </div>
</div>

<script>
    setTimeout(function(){ window.location.reload(); }, 30000);
</script>
<div th:replace="~{fragments/layout :: footer}"></div>
</body>
</html>